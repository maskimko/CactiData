<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:p="http://primefaces.org/ui">

    <ui:composition template="/template.xhtml">
        <ui:define name="title">
            <h:outputText value="#{bundle.ISXDevicesTitle}"></h:outputText>
        </ui:define>
        <ui:define name="body">



            <h:form id="form" styleClass="jsfcrud_list_form">
                <h:outputText escape="false" value="#{bundle.ListDevicesEmpty}" rendered="#{isxDeviceController.count == 0}"/>
                <h:panelGroup rendered="#{isxDeviceController.count > 0}">

                    <p:dataTable id="isxDevices" value="#{isxDeviceController.isxDevices}" var="item" rowKey="#{item.addr}" selection="#{isxDeviceController.current}" selectionMode="single" >
                        <f:facet name="header">
                            <h:outputText value="#{bundle.ListISXTableTitle}"/>
                            <br />
                            <h:outputLabel for="" value="#{bundle.ListISXTableUpdateInterval}"/>
                            <p:outputPanel>
                                <p:spinner id="updateAjaxSpinner" value="#{isxDeviceController.pollingInterval}" min="5" max="300" stepFactor="5">
                                    <p:ajax process="@this"/>
                                </p:spinner>
                            </p:outputPanel>
                        </f:facet>
                        <p:column>
                            <f:facet name="header">
                                <h:outputText value="#{bundle.ListDevicesTitle_hostname}"/>
                            </f:facet>
                            <h:outputText value="#{item.addr}"/>
                        </p:column>
                        <p:column>
                            <f:facet name="header">
                                <h:outputText value="#{bundle.ListDevicesTitle_port}"/>
                            </f:facet>
                            <h:outputText value="#{item.port}"/>
                        </p:column>
                        <p:column>
                            <f:facet name="header">
                                <h:outputText value="#{bundle.ListDevicesTitle_snmpComunity}"/>
                            </f:facet>
                            <h:outputText value="#{item.snmpCommunity}"/>
                        </p:column>
                        <p:column>
                            <f:facet name="header">
                                <h:outputText value="#{bundle.ListDevicesTitle_snmpVersion}"/>
                            </f:facet>
                            <h:outputText value="#{item.snmpVersion}"/>
                        </p:column>
                        <p:column>
                            <f:facet name="header">
                                <h:outputText value="#{bundle.ListDeviceTitle_sysName}"/>
                            </f:facet>
                            
                            <h:outputText id="isxSysName" value="#{item.sysName}"/>
                            <p:poll interval="#{isxDeviceController.pollingInterval}" update="isxSysName"/>
                        </p:column>
                        <p:column>
                            <f:facet name="header">
                                <h:outputText value="#{bundle.ListDeviceTitle_systemPower}"/>
                            </f:facet>
                            <h:outputText id="isxTotalPower" value="#{item.totalPower}"/>
                            <p:poll interval="#{isxDeviceController.pollingInterval}" update="isxTotalPower"/>
                        </p:column>
                        <p:column>
                            <f:facet name="header">
                                <h:outputText value="#{bundle.ListDeviceTitle_totalPower}"/>
                            </f:facet>
                            <table>
                                <tr><td><h:outputText id="power1" value="#{item.sysPower1}"/></td>
                                    <td><h:outputText id="power2" value="#{item.sysPower2}"/></td>
                                    <td><h:outputText id="power3" value="#{item.sysPower3}"/></td>                                     
                                </tr>                               
                            </table>
                            <p:poll interval="#{isxDeviceController.pollingInterval}" update="power1"/>
                            <p:poll interval="#{isxDeviceController.pollingInterval}" update="power2"/>
                            <p:poll interval="#{isxDeviceController.pollingInterval}" update="power3"/>
                        </p:column>
                        <p:column>
                            <f:facet name="header">
                                <h:outputText value="#{bundle.ListDeviceTitle_frequency}"/>
                            </f:facet>
                            <h:outputText id="frequency" value="#{item.frequency}"/>
                            <p:poll interval="#{isxDeviceController.pollingInterval}" update="frequency"/>
                        </p:column>
                        <p:column>
                            <f:facet name="header">
                                <h:outputText value="#{bundle.ListDeviceTitle_current}"/>
                            </f:facet>
                            <table>
                                <tr><td><h:outputText id="current1" value="#{item.current1}"/></td>
                                    <td><h:outputText id="current2" value="#{item.current2}"/></td>
                                    <td><h:outputText id="current3" value="#{item.current3}"/></td>                                
                                </tr>
                            </table>   
                            <p:poll interval="#{isxDeviceController.pollingInterval}" update="current1"/>
                            <p:poll interval="#{isxDeviceController.pollingInterval}" update="current2"/>
                            <p:poll interval="#{isxDeviceController.pollingInterval}" update="current3"/>
                        </p:column>
                        <p:column>
                            <f:facet name="header">
                                <h:outputText value="#{bundle.ListDeviceTitle_voltageL}"/>
                            </f:facet>
                            <table>
                                <tr><td><h:outputText id="voltagel2l1"  value="#{item.voltageLtoL1}"/></td>
                                    <td><h:outputText id="voltagel2l2" value="#{item.voltageLtoL2}"/></td>
                                    <td><h:outputText id="voltagel2l3" value="#{item.voltageLtoL3}"/></td>                                        
                                </tr>                               
                            </table>
                             <p:poll interval="#{isxDeviceController.pollingInterval}" update="voltagel2l1"/>
                            <p:poll interval="#{isxDeviceController.pollingInterval}" update="voltagel2l2"/>
                            <p:poll interval="#{isxDeviceController.pollingInterval}" update="voltagel2l3"/>
                        </p:column>
                        <p:column>
                            <f:facet name="header">
                                <h:outputText value="#{bundle.ListDeviceTitle_voltageN}"/>
                            </f:facet>
                            <table>
                                <tr><td><h:outputText id="voltagel2n1" value="#{item.voltageLtoN1}"/></td>
                                    <td><h:outputText id="voltagel2n2" value="#{item.voltageLtoN2}"/></td>
                                    <td><h:outputText id="voltagel2n3" value="#{item.voltageLtoN3}"/></td>                                       
                                </tr>                              
                            </table>
                             <p:poll interval="#{isxDeviceController.pollingInterval}" update="voltagel2n1"/>
                            <p:poll interval="#{isxDeviceController.pollingInterval}" update="voltagel2n2"/>
                            <p:poll interval="#{isxDeviceController.pollingInterval}" update="voltagel2n3"/>
                        </p:column>
                        <f:facet name="footer">
                            <p:commandButton value="#{bundle.ViewISXDetailsButton}" icon="ui-icon-search"  
                                             update=":form:display" oncomplete="PF('isxDialog').show()"/>  
                            <p:commandButton value="#{bundle.ListDeviceQuery}" >
                                <p:ajax listener="#{isxDeviceController.populate()}" process="@this"/>
                            </p:commandButton>
                            
                        </f:facet>                
                    </p:dataTable>
                    <p:dialog id="dialog" header="#{bundle.ViewISXDetails}" widgetVar="isxDialog" resizable="false"  
                              width="400" showEffect="clip" hideEffect="fold">  

                        <h:panelGrid id="display" columns="2" cellpadding="4">  



                            <h:outputText value="#{bundle.ViewISXHostname}" />  
                            <h:outputText value="#{isxDeviceController.current.addr}" />  
                            <h:outputText value="#{bundle.ViewISXPort}" />  
                            <h:outputText value="#{isxDeviceController.current.port}" />  
                            <h:outputText value="#{bundle.ViewISXSnmpComunity}" />  
                            <h:outputText value="#{isxDeviceController.current.snmpCommunity}" />  
                            <h:outputText value="#{bundle.ViewISXSnmpVersion}" />  
                            <h:outputText value="#{isxDeviceController.current.snmpVersion}" /> 
                            <h:outputText value="#{bundle.ViewISXSysName}"/>
                            <h:outputText value="#{isxDeviceController.current.sysName}" title="#{bundle.ViewISXSysName}"/>
                            <h:outputText value="#{bundle.ViewISXTotalPower}"/>
                            <h:outputText value="#{isxDeviceController.current.totalPower}" title="#{bundle.ViewISXTotalPower}"/>
                            <h:outputText value="#{bundle.ViewISXFrequency}"/>
                            <h:outputText value="#{isxDeviceController.current.frequency}" title="#{bundle.ViewISXFrequency}"/>

                        </h:panelGrid>  
                    </p:dialog>  


                </h:panelGroup>
                <br />

                <br />
                <br />
                <h:link outcome="/index" value="#{bundle.ListDevicesIndexLink}"/>
            </h:form>
        </ui:define>
    </ui:composition>

</html>
